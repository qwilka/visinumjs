<!doctype html>
<html>
    <head>
    	<title>TESTING vntree.js</title>
		<!-- <meta name="viewport" content="width=device-width, initial-scale=1"> -->
		<link rel="shortcut icon" href="data:image/x-icon;," type="image/x-icon">
		<link rel="stylesheet" href="/libs/jstree/jstree.css">
		<script src="/libs/jstree/jstree.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/uuid@latest/dist/umd/uuidv4.min.js"></script>
		<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
		<link rel="stylesheet" href="https://www.w3schools.com/lib/w3-theme-indigo.css">

	</head>
    <body>


		<div class="w3-panel w3-padding-16 w3-theme-l4">
			<button class="w3-button w3-theme-d2" onclick="clearTree()">Clear tree</button>
			<button class="w3-button w3-theme-d2" onclick="importJSON()">Import JSON</button>
			<button class="w3-button w3-theme-d2">Export JSON</button>
		</div> 
		
		<div id="datatree"></div>
        <script src="vntree.js"></script>
        <!-- <script type="module">	 -->
		<script>
			// let rootnode = new VnNode("root node");
			// let node1 = new VnNode("node1 level1", rootnode);
			// let node11 = new VnNode("node11 level2", node1);
			// let node12 = new VnNode("node12 level2", node1);
			// let node13 = new VnNode("node13 level2", node1);
			// let node121 = new VnNode("node121 level3", node12);
			// let node122 = new VnNode("node122 level3", node12);
			// let node2 = new VnNode("node2 (level1)", rootnode);
			// let node21 = new VnNode("node21 (level2)", node2);
			// let node211 = new VnNode("node211 (level3)", node21);
			// let node212 = new VnNode("node212 (level3) parentless");
			// node21.add_child(node212);
			// node21.add_child(new VnNode("node213 (level3) parentless"));
			// let node3 = new VnNode("node3 (level1)", rootnode);

            // //debugger;
			
			// console.log(rootnode.to_texttree());
			// //for (let n of rootnode) console.log(n.name);
            // let treeDict = rootnode._to_treedict();
            // debugger;

            // let jsonStr = '{"data": {"population": 7762609412, "_vntree": {"name": "The World", "_id": "bfa697c8-ac45-4d60-995d-579489d175df"}}, "childs": [{"data": {"_vntree": {"name": "Europe", "_id": "2d539852-e7a7-4638-8b9f-1e3b214700e3"}}, "childs": [{"data": {"capital": "Brussels", "population": 11515793, "_vntree": {"name": "Belgium", "_id": "b8fe32ff-8530-41e6-8545-895611b64260"}}, "childs": []}, {"data": {"capital": "Athens", "population": 10768477, "_vntree": {"name": "Greece", "_id": "8961914e-3f6a-416b-a497-0df35d46e07f"}}, "childs": []}, {"data": {"_vntree": {"name": "Scandinavia", "_id": "e1f05444-42ce-447d-a71b-885f39a6939e"}}, "childs": [{"data": {"capital": "Copenhagen", "population": 5822763, "_vntree": {"name": "Denmark", "_id": "25615c3b-2152-45a3-8236-fd207a73ff53"}}, "childs": [{"data": {"_vntree": {"name": "Faroe Islands", "_id": "301e8fc5-5e33-4a91-957b-dbfb4a75bc88"}}, "childs": []}, {"data": {"_vntree": {"name": "Greenland", "_id": "2961c99f-0225-4d80-a2e4-23505334c9ed"}}, "childs": []}]}, {"data": {"capital": "Stockholm", "population": 10302984, "_vntree": {"name": "Sweden", "_id": "8e48ec3c-2a67-48d0-a051-b923e60cea99"}}, "childs": []}, {"data": {"capital": "Oslo", "population": 5421241, "_vntree": {"name": "Norway", "_id": "3d53468b-1fff-4638-866a-71dc8a9659d2"}}, "childs": []}]}, {"data": {"capital": "Madrid", "population": 46733038, "_vntree": {"name": "Spain", "_id": "ae2da923-cf3f-469c-a8c8-258cb0827360"}}, "childs": []}]}, {"data": {"_vntree": {"name": "South America", "_id": "482e73bf-4c16-4774-b46f-627e29bc032f"}}, "childs": [{"data": {"capital": "Santiago", "population": 17574003, "_vntree": {"name": "Chile", "_id": "1fc8679c-f57b-4346-a91b-a9cf112f6037"}}, "childs": []}]}]}';
            // let rootnode = VnNode.from_JSON(jsonStr);
            // console.log(rootnode.to_texttree());
			// setTimeout(() => {
			// 	console.log(rootnode.to_texttree());
            // }, 100);
			// console.log("jstree=", jstree);

			let rootnode = null;
			setTimeout(() => {
				if (rootnode) console.log(rootnode.to_texttree());
            }, 10000);			

			


// const attachDatatree = (treeData=null) => {
//   var c = 0;
//   function dummy(levels, nodes) {
//     var data = [], i;
//     for (i = 0; i < nodes; i++) {
//         c ++;
//         data.push({
//             'id' : levels + '_' + i,
//             'text' : 'node ' + i + ' ' + (i === 1 ? 'lipsum lipsum lipsum lipsum lipsum lipsum lipsum lipsum ' : ''),
//             'children' : levels > 1 ? dummy(levels - 1, nodes) : []
//         });
//     }
//     return data;
//   }  
//   //var instance = new jsTree({}, document.getElementById('datatree'));
// //   instance
// //       .empty()
// //       .create(dummy(2, 10))
// //       .openAll();
// //   console.log(c);
// //   let tree = instance.tree;   // 
// //   let root = instance.tree.root;
// //   //testnode = instance.select({"id":"2_0"});
// //   //testnode = instance.tree.find({id:"2_0"});
// //   let testnode = tree.find("1_2")[0];
// //   testnode.data.text = testnode.data.text + "_testnode";
// //   console.log(testnode);
// //   instance.create({id:"a1", text:"new test node"}, testnode);
// //   instance.select(testnode);
// //   instance.redraw();
// //   instance.openAll();

// // instance.empty();
// // let tree = instance.tree;
// // let root = instance.tree.root;
// // instance.create({id:rootnode._id, text: rootnode.name});
// // instance.redraw();
// // instance.openAll();
// // debugger;
// }

// attachDatatree();


// let pnode = PNode("root node");
// let pnode1 = PNode("node1 level1", pnode);
// let pnode2 = PNode("node1 level2", pnode);
// let pnode11 = PNode("node1 level11", pnode1);
// let pnode12 = PNode("node1 level12", pnode1);
// console.log(pnode);
// console.log(pnode.toTextTree());
// for (let n of pnode) console.log(n.name);


var importJSON = async () => {
	let [fileHandle] = await window.showOpenFilePicker({startIn: "documents"});
	console.log("fileHandle=", fileHandle);
	let file = await fileHandle.getFile();
	let jsonStr = await file.text();
	rootnode = VnNode.from_JSON(jsonStr);
};
var clearTree = () => {
	jstree.empty();
	//jstree.redraw();
};

</script>

<!-- 
<script>
	var import_JSON = () => {
		window.showOpenFilePicker();
	}
</script> -->

</body>
</html>
